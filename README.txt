Refactored Code

What's Amazing
It pretty good to use the repository pattern with laravel.

What's Ok
It Ok to use ORM but good if we are using join to opitimize the queries.

What's terrible
Too much looping and conditions
